# This workflow will build, package and Sign windows, MacOs, Linux App and Deploy it.
#
# To configure this workflow:
name: Build, Package, Sign and Deploy Windows, Linux and MacOs Apps
on:
  pull_request:
    branches:
      - master
    paths:
      - "maintemplate/client/**"
      - ".github/workflows/build-sign-deploy-desktop.yml"
  push:
    branches: 
      - master
    paths:
      - "maintemplate/client/**"
      - ".github/workflows/build-sign-deploy-desktop.yml"

jobs:
  build-package-sign-linux:
    name: "Linux Build, Package, Sign and Deploy"
    runs-on: [ubuntu-latest]
    env:
      GOROOT: /usr/local/go
      GO111MODULE: auto
    steps:
      - name: Install Go
        run: |
          sudo apt-get update
          wget -q https://dl.google.com/go/go1.13.linux-amd64.tar.gz -O /tmp/go_install.tar.gz
          sudo tar -C /usr/local -xzf /tmp/go_install.tar.gz
          export GOPATH=$HOME/go
          export PATH=$GOPATH/bin:$GOROOT/bin:$PATH
          go version
      - name: Install Hover
        run: |
          sudo apt-get install libgl1-mesa-dev xorg-dev
          sudo apt-get install gcc libc6-dev
          export GOPATH=$HOME/go
          export PATH=$GOPATH/bin:$GOROOT/bin:$PATH
          go version
          go get -u github.com/go-flutter-desktop/hover
      - name: Cloning repository
        uses: actions/checkout@v2.0.0
      - uses: subosito/flutter-action@v1.2.0
        with:
          channel: beta
      - name: Setting Up Flutter SDK
        run: flutter pub get
        working-directory: maintemplate/client/
      - name: Build Linux Application
        run: hover build linux
      
  
